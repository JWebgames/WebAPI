language: python
python:
  - "3.6"
install:
  - apt install libyaml
  - python setup.py install
  - pip install -r requirements_test.txt
env:
  WEBAPI_ROOT=$PWD/webapi
  WEBAPI_PRODUCTION=False
script: 
  - python -m unittest -v
  - python -m webapi dryrun
after_success: 
  - coverage run -m unittest
  - codecov
  - pylint webapi --reports=y --const-naming-style=any > /tmp/pylint-report
  - curl -v -m 30 -X POST -F pylint-report=@/tmp/pylint-report https://pylint.julien00859.be/reports
  - python setup.py bdist_wheel
  - pip install twine
  - echo [pypi] > $HOME/.pypirc
  - echo username = Julien008 >> $HOME/.pyirc
  - echo password = $PYPI_PWD >> $HOME/.pyirc
  - twine upload dist/*
